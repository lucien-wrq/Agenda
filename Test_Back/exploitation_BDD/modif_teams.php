<?php

if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_POST['id_team'])) {
    $id_event = $_POST['id_team'];
    $label = isset($_POST['label']) ? $_POST['label'] : '';
    $description = isset($_POST['description']) ? $_POST['description'] : '';
    $modif_date = new datetime(); 
    $modif_date_formate = $modif_date->format('Y-m-d H:i:s');
    try {
        $db = new PDO('sqlite:BDD2.db');
        $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    } catch (PDOException $e) {
        die("Erreur de connexion : " . $e->getMessage());
    }

    $sql_update = "UPDATE teams SET label = :label, description = :description, last_modification_date = :last_modification_date WHERE id_team = :id_team";
    $stmt_update = $db->prepare($sql_update);

    $stmt_update->bindParam(':label', $label, PDO::PARAM_STR);
    $stmt_update->bindParam(':description', $description, PDO::PARAM_STR);
    $stmt_update->bindParam(':id_team', $id_event, PDO::PARAM_STR);
    $stmt_update->bindParam(':last_modification_date', $modif_date_formate, PDO::PARAM_STR);

    try {
        $stmt_update->execute();
        echo "Modification réussie";
    } catch (PDOException $e) {
        echo "Erreur : " . $e->getMessage();
    }

    $db = null;
} else {
    echo "Aucune donnée de modification soumise";
}
?>