
<?php
try {
    $db = new PDO('sqlite:BDD2.db');
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    // Récupération des données actuelles du groupe
    $id_team = isset($_POST['id_team']) ? $_POST['id_team'] : null;
    $label = isset($_POST['label']) ? $_POST['label'] : '';
    $description = isset($_POST['description']) ? $_POST['description'] : '';

    // Traitement du formulaire de mise à jour
    if ($_SERVER['REQUEST_METHOD'] === 'POST') {
        $sql = "UPDATE teams SET label = :label, description = :description WHERE id_team = :id_team";
        $stmt = $db->prepare($sql);
        $stmt->bindParam(':id_team', $id_team, PDO::PARAM_INT);
        $stmt->bindParam(':label', $label, PDO::PARAM_STR);
        $stmt->bindParam(':description', $description, PDO::PARAM_STR);
        $stmt->execute();

        echo "Mise à jour réussie";
    }

    // Initialisez $team même si le formulaire n'est pas soumis
    $team = [];
    if ($id_team && is_numeric($id_team)) {
        $sql = "SELECT * FROM teams WHERE id_team = :id_team";
        $stmt = $db->prepare($sql);
        $stmt->bindParam(':id_team', $id_team, PDO::PARAM_INT);
        $stmt->execute();
        $team = $stmt->fetch(PDO::FETCH_ASSOC);
    }

    $db = null;
} catch (PDOException $e) {
    die("Erreur de connexion : " . $e->getMessage());
}
?>

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="modifierungroupe.css" rel="stylesheet">
    <title>Modifier un Groupe</title>
</head>
<body>

    <header>
        <h1>Modifier un Groupe</h1>
    </header>

    <section>
        <form action="modif_teams.php" method="post">

            <?php if (isset($team['id_team'])) : ?>
                <input type="hidden" name="id_team" value="<?php echo $team['id_team']; ?>">
            <?php endif; ?>


            <label for="label">Nom du Groupe :</label>
            <input type="text" id="label" name="label" value="Nom actuel du groupe" required>

            <label for="description">Description :</label>
            <textarea id="description" name="description" rows="4" required>Description actuelle du groupe</textarea>

            <button type="submit" value="Modifier">Enregistrer les Modifications</button>
        </form>
    </section>

</body>
</html>
